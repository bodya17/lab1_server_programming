using System;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Windows.Forms;
using Interface.DataModel;
using System.Data.Entity;
using System.IO;
using System.Drawing.Drawing2D;
using System.Drawing.Imaging;
using System.Text;

namespace Interface
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
            this.isIDAtZero = true;
            this.renderUpdateButtons = true;
        }

        private bool isIDAtZero;
        private bool renderUpdateButtons;
        private string SEPARATOR = " / ";

        private byte[] openFile()
        {
            OpenFileDialog theDialog = new OpenFileDialog();
            theDialog.Title = "Select Image for book";
            theDialog.Filter = "Image Files(*.BMP;*.JPG;*.GIF)|*.BMP;*.JPG;*.GIF|All files (*.*)|*.*";
            theDialog.InitialDirectory = @"C:\";
            byte[] data = null;
            if (theDialog.ShowDialog() == DialogResult.OK)
            {
                string path = theDialog.FileName;
                FileInfo fileInfo = new FileInfo(path);

                data = new byte[fileInfo.Length];

                using (FileStream fs = fileInfo.OpenRead())
                {
                    fs.Read(data, 0, data.Length);
                }
            }
            return data;
        }


        public void Display()
        {
            using (LibraryContext context = new LibraryContext())
            {
                var bookList = context.Books.Select(x => new {
                    BookId = x.BookId,
                    Title = x.Title,
                    Authors = x.Authors.Select(a => a.Name).ToList()
                }).ToList().Select(x => new {
                    BookId = x.BookId,
                    Title = x.Title,
                    Authors = String.Join(this.SEPARATOR, x.Authors)
                }).ToList();

                var authorList = context.Authors.Select(x => new {
                    AuthorId = x.AuthorId,
                    Name = x.Name,
                    Age = x.Age,
                    City = x.City,
                    Books = x.Books.Select(b => b.Title).ToList()
                }).ToList().Select(x => new {
                    AuthorId = x.AuthorId,
                    Name = x.Name,
                    Age = x.Age,
                    City = x.City,
                    Books = String.Join(this.SEPARATOR, x.Books)
                }).ToList();

                book_data_grid.DataSource = bookList;
                author_data_grid.DataSource = authorList;

                this.authors_list.SelectionMode = SelectionMode.MultiSimple;
                this.authors_list.DataSource = context.Authors.Select(x => x.Name).ToList();
            }

            if (this.renderUpdateButtons)
            {
                var buttonCol = new DataGridViewButtonColumn();
                buttonCol.Name = "ShowImage";
                buttonCol.HeaderText = "Image";
                buttonCol.Text = "Show image";
                buttonCol.UseColumnTextForButtonValue = true;
                book_data_grid.Columns.Add(buttonCol);
                this.renderUpdateButtons = false;
            } else
            {
                isIDAtZero = false;
            }
        }

        private void Form1_Load(object sender, EventArgs e)
        {
            this.Display();
        }

        private void createNewBookInDb(object sender, EventArgs e)
        {
            //string DEFAULT_IMAGE = "0xFFD8FFE103A5687474703A2F2F6E732E61646F62652E636F6D2F7861702F312E302F003C3F787061636B657420626567696E3D27EFBBBF272069643D2757354D304D7043656869487A7265537A4E54637A6B633964273F3E0A3C783A786D706D65746120786D6C6E733A783D2761646F62653A6E733A6D6574612F2720783A786D70746B3D27496D6167653A3A45786966546F6F6C2031302E3430273E0A3C7264663A52444620786D6C6E733A7264663D27687474703A2F2F7777772E77332E6F72672F313939392F30322F32322D7264662D73796E7461782D6E7323273E0A0A203C7264663A4465736372697074696F6E207264663A61626F75743D27270A2020786D6C6E733A4765747479496D61676573474946543D27687474703A2F2F786D702E6765747479696D616765732E636F6D2F676966742F312E302F273E0A20203C4765747479496D61676573474946543A417373657449443E3533323835323334353C2F4765747479496D61676573474946543A417373657449443E0A203C2F7264663A4465736372697074696F6E3E0A0A203C7264663A4465736372697074696F6E207264663A61626F75743D27270A2020786D6C6E733A64633D27687474703A2F2F7075726C2E6F72672F64632F656C656D656E74732F312E312F273E0A20203C64633A63726561746F723E0A2020203C7264663A5365713E0A202020203C7264663A6C693E656C656E616C656F6E6F76613C2F7264663A6C693E0A2020203C2F7264663A5365713E0A20203C2F64633A63726561746F723E0A20203C64633A6465736372697074696F6E3E0A2020203C7264663A416C743E0A202020203C7264663A6C6920786D6C3A6C616E673D27782D64656661756C74273E737461636B206F6620626F6F6B7320696E20686F6D6520696E746572696F723C2F7264663A6C693E0A2020203C2F7264663A416C743E0A20203C2F64633A6465736372697074696F6E3E0A203C2F7264663A4465736372697074696F6E3E0A0A203C7264663A4465736372697074696F6E207264663A61626F75743D27270A2020786D6C6E733A70686F746F73686F703D27687474703A2F2F6E732E61646F62652E636F6D2F70686F746F73686F702F312E302F273E0A20203C70686F746F73686F703A4372656469743E476574747920496D616765733C2F70686F746F73686F703A4372656469743E0A203C2F7264663A4465736372697074696F6E3E0A3C2F7264663A5244463E0A3C2F783A786D706D6574613E0A3C3F787061636B657420656E643D2777273F3EFFDB0043000A07070807060A0808080B0A0A0B0E18100E0D0D0E1D15161118231F2524221F2221262B372F26293429212230413134393B3E3E3E252E4449433C48373D3E3BFFDB0043010A0B0B0E0D0E1C10101C3B2822283B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3B3BFFC20011080198026403011100021101031101FFC4001B00000203010101000000000000000000000102000304050607FFC4001801010101010100000000000000000000000001020304FFDA000C03010002100310000001F1C4212A1208558796C14AD22DB2D92840B014972B56C5D2ED97A069331CA4E5EF3559084204D98DF571AE94B788675E718378CBACAD900009D1C6BBF8DF40B5116B8A4A4BB536EB37EA14040288042A285AC05897EA1A100F9D2425421221084A818146570CB0832AA0B18B65BA5DF2F40D2663929CBDE69B204695E5874F1AECE75D0B2CA52B971E35CCAE5F4C66DF30021647679F4EDCBB29A10AE292B346F3AACBAC800001290D942F3A314A86D3A3ACD9499AA7CFB792008004224A8421084244205604B16D8BE5DF1D15D2663927277852C96F96FC6AC9AACD69D236166A424519DF2E5E3EF18FAF2002174BD4E7BEBE75B6C25714CB506CDFBCEAB1D008AA40D8D29B332F1F379F40E8C75ACB8A3373E6F8EEB932CB0501524A036016C040592212A10834B616CB7CBD097A2694CCBC939B736CD69CDE84B767473AAC54D966AB1AC3A42997979BC6DE31F5E600018D59D7471AE9E2DF2A19B4A6CD9674B5352110AD560D9658E031CBC25C6857A11D8B2F5A72C38D799EB0E6CB058050CAC3104B2BAAEE6BB011212A10696C2C9744BD197A269334722B326BC6F6CBAD1A6973AAE259A92FD0D875219E5E566F1BA631F4E6A401063A3CF7DCE5BDD2A996B1EB3D1DCE8DCE914AC45814B2C610E74BC02918DF2F62CD2B4472B1AE0EE194D82C1015E5B25B50AA14D946F34DCC9620A082A0472D9744BD197A4684CEBC9298DB9DEC8B91A6933AAA0D6B4BAC6A3ACAD519BCB978BBC62EBCC108409D5E5D3D0F2DEC218E316E747A637D975825501024B094AF22384253C6C5EC26B295E5E6F0AD306C160814D9D5B2DC3C215567DE68B933462504149732C72C9744BD297A2694CCBCD8AE5D735A22C46CE966A8941A92F434770599E5E61C9DE3274E6A4210274F974F45CB7BA9230465E93A7BC6EB2EB00928252805339C68E5D9062E5DE6C85321C368C320A828D9D5D2DA8EAA5467D669D432994904B12E46B2EB646997A52F44D099D704552DF34E324CECCB9E12AF8BC5B0589545982CC5BC53AC82108435E75DEE1D7A10A73B531EF3D0AE959758A2085656545499CC4554461A2C1824392A4620003CD5B9B70C48AEB3EB346B214CA42012E6596164BA65E9CBD1342675E74B90328B00659359EC5B2C828949657625882D8000090239BF9EFA18D9316B39779B4D814ACACAC4168002421024210803229834114030F2D834B052AD4AAE6102B22504258592E997A72F48D09997951CFA5956C4A08857AC8202C802054C10008408425D2EACD25362D42048121024204910802128108659A8116C4B90915A194908258B64210840865B0B25D52F4E5E9A5C665E5CBCE869AB336BD4A359CFBC5764A0902421252100084204736E6EC9655288156084218210902408481A812213833648AB7356B010ADB9D3AC4002BB13598420D2B1003AD91AA5EA4BD2B2F9739CFCDCD9D69C6F4C5358759C1D319778AEC9509048121080200242C3AF9D75A2FAA4A4618210A304210D409024210840578EE7B5522595EB10B25BF3AB25842BB28D669D641025D2DB2AA57A42C8D52F565E9597CB9CC92A635AF3745944B9179DACE1DE736F9A541C22908420084210B63B935E80BE5AD168EA1B09024211090042114240008A0F3BC7A675CE65D45B9796D96E9A68242AACDAC53A90039B336C969D673582AC8D72F565E959799E5CB2AE75B32BACAE6A8CB9F758778C1D3953A9B33766365336A66D44B2E9B79BA2C006620B1E3BB9BE94D2B1149A8BA81169658358C420A00800004A1252CB9796E99712F32CCB65D9D32B441C85759F59AAA4B12D4D92B98F59CBA912C975CBD597A565EB9E32CB5F3DEC8B04CD55CAB8B78E576E49676F96F7E74F6D2DB5BD18D933C5CEB9EA04A00A02D8E9658C30D7268A0B20C35975968C0097330028A02159D0CE94CF1CC979A24D31122B04ACA3594532CB2F4D50958358CFA84B65D72F5A5E95972E78CB9B5F3E9AB36CB04A0A0C3BCF2BAF22BE9397A3B09AAF3B98303361C0C76E767A0A882A2416A0125282C08B4A82802C514002AEBCF64444A020A110F6F1154C92F2F370AA110AB10AACA2C55795934D97C65D4E7EB35596164BAE5EB4BD2B2E5CF19736AC74D39B62495ACA4C3B9CDDF3975EC78F5EC5E12A408129B3CF72F4609B84B002C00A08080A08B4054150040125955F6E38D169695010803E8B910152E0CDE44B96A055A215594EA2CB6CD5ACEA0D982E70EF20B16C8D92F565E9597144B925A71BD59B658658999706F3837CED6FD7F2E9D8BC21012C01C2C76C59D28001155404414B41169516A010056121ABD0F5E381522AAE36B3CFD432B10FA2E5082AE4978B9BCAD40119615D95D816D96E92E16CC5ACE6B0962D91B25EB4BD2B2D28970CB8F3ABA5B658299ACC3BC63DE34CDFB7E5D7ABBE18EB0B5CDBAE7CD675C211918742384680324220210812240015E5F5173A6CA853CFC79CE98032E9CDF7B014A45A23892F0779AAC2A430B4A915E5B11C44CFA8B6196C5B2364BD797A365C6697991CC592B40B52CAAE73EB355969B71D9D9E970EA79F45B6B050145B00B60B010212103100422C48A009759E9BAF1D563A50B5479F3CE74C0097CBEFB3A41C72A38F9BE7378A3518304AE9522C08400494D2BAD91B65EB4BD2B2D334BC638FACD29280004A840C587A9F27A3472E95DB45B5D0A5451696C8042108D212116000400A01AB4EF1DEDF3D57352D11E6AB83BC0202CFA2F3E8904B2899E3258A114A971271F59CF64A32C1C79422D32D91B65EBCBD1B2D334BC54E2EF350480004695A5276E3B3E7EED8D24576D622AD25289601505188304802100400A035EB3DCEBCACB2F445CB1E6AB87BC29089F47C6EB96CB3458C40D0042954B997931C5D65A562298529B29D45AB636CBD797A15699639472D156C960A01E5BB36FCEB6EB3D9E98BF9EE8E7B020915CA8201504A020016120004000828294B2CF49DB8D05E43912F9ED6716B2A421F51CD518B40358F4002C24B54B957245C68A512299719C7B306F265D91D25DE5A65979E640CD5D2980AD25C699742747AE35DCF29734A914D5629A214801455AE156BB00A0144B14160000D46932DCD4BD9CDE81E6EB9BA89604043EB02C408AAC965400049522B954B4B8614ACC52F065E46A555646934CB61419E925796E0CAE7624EBEB2E40A110C19B4CD66CEEBCD32F4758DBD31000244AE64D73B3A912A005336A534882A1B758F5967163895A65DD1C0DE71D805B200FAE228AAB2887D46B0C4502C24AA41CB4B20952E15E1CB85735988961210049582109EA333D3EF108421090049ACF9DE7CEADB36EF935900424B933BF3DE7EEB51012AB28D28B2BA5B905DACFB1D6729925CB192B89ACD36412C843EB90014808344291402165000CAE970C54BC89788D5A5271B59A2804840C1204B23D8C7A1D6210842122540424D095EE4D908424BCEC74E271EAB5108B5595D5565555849BC7B0D66B31CBCE8E56A73F5110805B21F5C800A58000848059080082585A3141E673BC96EB4CE72359CD510AC210243566F7B17B67435821011011621028029090208532637E771BA8AE92C4B009494A80952CF4B25358170A64D669B00020A09F590C414101604040092808003117147999BAAAD4AACC16536008561085B1E8B37B3C7A68028122003612B5AC82A18AC45292815DB6272A5CBA9767465057405B141522012BD14CDD39A6B9A801615804FA54B7160C0804201562005529081157999BE72E821AA932D95590622C4839E8F37B966BE5D1F28B1254004009600809402504160567397359E5057404A4B210510620122E2E98CFD782901510A83A396E5EB9D02E1E0904154840408428AB825F34B5512B4CD65764188009E8A3BC6E1F8F49025961212A402509492C901444A10160538F9E9C89A5B12A42595E8A8280119640A865DE33F4E20940891616C296CBD197B92EC4B698484564720460D1018A5E0358EC22266B2AB204844E8CBEB8DD65BCF731A240910D448B01014A051108AB01610079CCF4C0A4449496258A82951D4C15003076E556B98A09084217E74C5D2DD2EECDE897A594D61187A230421019A38735CAD528899ECAAC084156C7A797D055F65714E74A585A09785CBAB8D56A3C592DE9758C1B156418065AC92F026C8B6574889A8A0B151682412CAEA50B909082D048437E357CBA25D26B2F2EB2C1A9860902408053347226B91A014CF735582C8134E6FA75ED96A6633CA4B6B45CDABCEF27A6B9ACCB96B2566D4A6C08E5965B16A58684B0C78DE1D452AD44B1116C5B058D054CA469484CBBE6BAC9522A2D401E8396EF5B92F2D2DA74B29884200802402B32AF1D79F44529D66A484196D8E9C770B4C2B9A341AADD69699F9F4B648A2125AA6A85CC536E7B33D95595D8B41010240C34B667564AF2A6B0B64059082D9977CEADE0AC212212BD2F1E960E38E1186B090128200052B92DCEB9CAA942AD356675D0B9DDAE5C9C75E774E2B4D16A3AA00EA63D1D1E5B8AA158952AD1B9444AAAAA05CA8A95DCD57155CAA00054062CCEEDCE9B35EE46A57735EB35D956B29640108409161E8B8756085591823042B084080F47BE74573B3BC73550892AC8D13564B7A589C3D6799B800420ABD1C5F57CF4011280012816000550215AA348B5AD75595D9555759B58AEF3565751A215E86E1488014101084210F45C3B152118686A210840589BACBACEA6B0D2D0B9F3AA250108E024A1785ACE3D40018610D52FA9E7A04200000108404A102800251099AB092A2D670FB4CDBC576442428DE5EE129408080A0808421E878772304230D0689085A9E837CF273E8B2DD6747A73A66B34B5674060D8490AA25E0F4CE7B1862E2D451A76EA66DECB8C8C912025009548020002CA3340B9AB28854F39D6E6DE1352241352BD46614AE92C040108856013D070EE42108C1204845EA5C6B8F3EDC3B1875FAF352896ACEA0C90205418F23D32B56C39A0D290ACD72F52530B6AB4AB000510140255096336332492885956511E776C9BCE7DE6BD652C62D8AEC544A4B140908420487778772397430C108421365CEC5E64A0DB73B16DD669CE9252321008A92B599EC61AC6186A81265CFE3DA8C6D0A94D14946C6434436114ADAADA555B12A538D2E0B9C9AE2D72468363193529D40888B412042A4843ADC7A95EFC9BEC21204810900532DF640CA6C4944AC8C4156B8AA5DBD79B8B2809084210C7CFA73B876151114C2D00104A5050104A00B1014A90842002049651D7965E98445B0201E69820010EA72E9B63D1D8C8560484090A46A64AF3A620656492B5320125A5553B3DB902B32CD61C6B758E4210C38DF378770A510B081244B1402DA82D220A4129400B000160141601EE5FA72C1A99B59096CD6B96B45A42B42BD8E5D3D126A08481204873E6F56F9DA964AC2634AA47B066C20B152E597ADDB8DB5CDCEB9F35856B97D25C68B2108552BC99A6B9F35AF788000156145954AD6B8ACAD6B0125202104A4A444A51D37DC42A395D79D75D4CDBC264316A567A4E5BED842124125108B2E29D1F58A25AA6A165861450C2D2890A68DE69CDCD3486B93A5737D8E3D30425F73925E5E3A75F7CF373DACA002805502890284AA22D222A0A2D28A8B5120680A57ACE0EDC12DD51BA18A4A6CACF67CF7684240C41894621256869522A96B1412A08215DB5959595553A2D8F16974B60F16D962586B4C56DC4E5BCF8D0B20000A500B50840001482528A25281054188804D4ABA72C9A95D8E420C591ED39EC8C12410902153060CA459724669695A8AAABA5052D95D8828F2B8C585D0E400B4A6DCB0DBD0B9D3CF59F3A044141545B1541084052811694028B4A0400A8402259A75954AEB36B39F510844F77C7A351090210C1084695A0D0CDAA5C92E0ACB65257495030F2BAB43160E588F63D3430D4E974A22ED4AA5CB8D014512944AAC5A0045A0281169400B00084B012570C0AB11AC5A5025559F528B3DCF0DB535424108688478608622820082C2829400965914C358F450848458486004A8A86000516555912C8B101080960036004400A0554554169AE5290412905453D0E4698906A046A21186834621225101084090840D088125489422108B2206A4005448022888020080A808504A08040400059650024A9624AA22A256A874996A2494A108D5298230D102452448B089081210950912A122542122125012008420084B028804200942000100504B016400080A08280B2A0A20A7FFC4002F100002010401040104010402030100000000010203111213041014202130051522314023323441243342435060FFDA0008010100010502F2B973233331C8B97132E5CBF4BF54448113FD4CA84FCE1029D22344D4874512A254A44A035E546252889756319023F0B1C8CCCC52FE1DCB972E5CBF5444810E932A13F0C4C051F74A253447AB4548138125E305EE8A202EAC7D222F86454958D86C29C85D6E58B7F15112043A4CAA4848C4548548D66B20880997EB22A7EA7E302948A73148B8E4391911F6E22F0BF8CCACC6FA5123D245C48B162C58B162C62625BE4444810E932A961408D3234BD6B302501408C4B7848ABFA9F8A23329D42322E324CC8A4405D1F932A32ABF7D2891E92FD5C5D10C658B189898988D16F89112043A4CAA5884451EAC6244578CCABFA9F9D229C4511C09C4B7BA7122BABE962DD64557EAA3F7D2890E9324FDF443E8BA2E962C3435D2C58B16F1440A647A4CA9FB29A1783111F191549F922894D090C99FF9408F5B162DE1265797A93EB4994E4644DFA97EFA218C5D178487E16F2440A647A4C92F76202F0909919172E5CC8948A9227E741949FA43654645FE50645972E5CB973232332532BCEE3FDF48B21315425506CB9710C7D57831FC48814C8F498FA2919191999929998AA1B0DA6E1D6255494C6FCE94ACE95414C94CA9314FDD3AA46A1B0D86D371BD0F9087C81F24957B9295FC723366665D2E265CB972E265CC8B8D8D8FA5CB972FE08814C8F49921C8CC750D86C3612A8662A86E371B8DC6C32F817A29D42354750948B919D88D7B0F92772CDECDD23633265FCEE5CB972FE372E5CB9919190D8DFC48814C89FEA65424CB8CB990E65CB972FF003444C721BF2B162C58B162C58B162C58B163131FE3A2053227FA99511288A06B1D31C06BF82884454CD43A66060606B359ACD66B359ACD66A351A8D469349A4D26934F83F048C4C4C4B79D8B75440A647A489A30214CD64A99381380D7F023FBA312303512A269349A8D46A351A8D46A351ACD66B359ACC0C0C0C0C0C4C596E8FA584848B162C343F148C4B75440A647A486588A2C344A25488D0D75C4C7E38FEF8E538FAB0E260606262626262626258B162C58B162C58B75744748701AE890978B1F4B74488C4C490FA2205323D243E91EB245444A24FA4298A91A49521C7A42855A854E354A4F091848C6462CB323FBE3A20BD626258B16EB72E5FE6C074C9D22702C245BC58FA5BA244464FAA205323D243E912FD19244D13211BBA54C50301D0CC8FD3B229FD3D445C4A67329518F230A46BA46AA669A66989A11A45B51B3948DDCC3B9E6A3BDE69F70E61F71E49F71A87DC4FB844FB95317D5289F73E31F71E333BDE3B1726949EC361B0D86D369B4DABA58944A94C9C05E4C7E11424489BEA8814C8F490FA47C2454FD4D10FC4E2D39558C78A2A1042497873BFC82C58B16E962C58B162C58B1898962C58C4C4704270849724EE4EE4EE47C83B867706F7D5A2712A406BC98FAA4247FA9B24FAA205323D244BA47C24541AF76FC3E9BFE2F9733DF26C626258B16F0F67B3D9EFA7BF82A5068C4B3F89A2A449A2E5CB972E318BA44432A31F5440A647A4891722CB972E4A45465CFFD5F4DFF0017C6C72A3956D7330998C8B32CFC2FD6E5FE187FD93A3725C6476C87C5456A78BF364D1586FDDCB972E365FA5C4CB8E44DF822994C8F49136391199B0D83A84AA139997B4FF1FA6FF8CE70892E771A24FEAD4624FEB7325F57E548FB8F26FB4DCCEE268EEAA9DED63BEAE7DC2B1F70AA7DC267DC2677F33BE99DEB3BB3BA89DD44EEA277303B9A677303B881DC5321573746AD6AB2712C38FAE5447FB10BF5E132BA27FBB991919172E5CB8A464390DF822994C8F491519290A66C361B075072E91911AD24B664A14294A96981AE2628C518A314628C5182304608C11823046B46B30303030303031313128C7FAEAB214AFD18E5EB992F052F45FAC8E422A277C59848D7230634D785CB97F14532991E932B32723232322FE3723791C656E3D868712C58B162DFC282CA70A5514A9FE86497AE67C3892A5725C44C5C447688ED90F8C54E31529B8F8D8B16EA8A65323D26562658B1896E96313035B2871BD2A78C712C626258B16312C58B16E96F9389FE46288F464DFAE53F168C450144B16313031301C09532B50B92A1ED719B3B5676CCD0C7498E0C6BA22994C8F49954944C0D66B359AC548544540A3C6F70A64A362C58B0D0D1631313131312C58B162C5BE1A32C2BCDD8DA853252F55AB58AB532F1B1889755E4D1280E8A64689A51A11A07C744F8E8A90B0D0881091190E44A4498C4848B090A9C854A62A52234D90809152BF24EEE487CF48FB9447F5481F72C9EFE49BF926DE51B3966CE59B3946DE49BABA3B9AA77550EEE677733BB99DDCCEF2477723BB91DD4CEE6650DFC972E172DA50ADC53B995F8F5F25297AE44AEFC6C5BC179B462288918988E254895E04A0584C8CC550DA3A8391713131B29CF17C7FEBB5C73B73B7349AA44A8392FB5D125F4CA43FA7C11DA5342A108BA5094CED8ED4ED11DA23B53B691CBE13947B4A676B4CED699DBD23B7A63A301D3438231458B23E9EF0E6C8AF4B225C6F746389297E359FBFE1A1756542B181529F4C8CCCCC8B97323333323E90EF1F81C474C749108622F2E4BB71FADBAB4345862450FF389449410D58AB2F537EFF88BAC8E454C52FC9D89AF53FDFC318E4FE990C23F158B79F33FE93D1E8F47A3D0C76E8FA537FF002EE364E454A85498FF008C9972523973BCE12F7726CA9FBF82952D8E970A45084A91B0CD19A3623644D913644D913644D913640CE26713245D172E5CE447652954A7096FA23E4D03BBA277548EE11B8D9233A86554BD529B96FEEA9227CFA254E5C18EAE449F9DFF008171B2ACECAA4AF33225227F042193E3D2B2A6A497E47E43CCFCCB4CB4CFCCBD43FA87F554AF50FCAFFEED031A628F1CC78663C12DC2453E2D1A91AD4A92953C4F48BB2F3B7E67E57FCCC6460608C226101D389AE27F6C9F9AAA853322FE372E5FCD95FF004FF7D192F3845CDD0E362A9D3B097858B162C58B1898962C62626262626054A39AE4D2B55F67B2C7A3D74F5F054FEEF35CBA9129FD40A7CC8C8556E29972E5CB972FE6CABFAA8AD3E8C7E495DF128594222458B16FE07A3D1639CBDDFA5CC872323232322FE353DFC124242BA29579C4A75AE299999191919172E5FC1950AEBDF463F2E352CA54E164974B97EB7F8AC5BA58B75E5D4D958C4C4C4B1E8B22CBA7A3D7572B293F8521445129A6445D6C5BA5BCA6575D58FC628E1C3D4574932E64CC9889656973AB426BEA67DD207DD28597D46833BCA4C5C8A6CCCC8B9922EBA65627CBA50A35B9D8D0DF036A371B91B0CDB2E5CC8D88DA6D1D5332ECF57F3C4501408D323112122C58B79DCB9365625FB18FC607165F8C5972723232F7722CBFA761D34C7C744B8C4B8EC7499833F246DA913BAE42173F9485F53E4A17D56B27F7823F57A76ABCDA55273AD4A46F88EB3364CBD466350C2660C513066B35A30458B153FBBCD4051144485E172E646464646464663993A88AB32FD18FC5142AE24790ADBD13E41DC11AAC53646A7ADB1B2E453375236512F4998D31D288F8E87C61F198F8EC7459AD9896F81757E367D2A7EFCD74B991919999999999999191919152B2A64B9890F983E4366CB99A36236445A994B8BC6AAE7F47A58D4FA7CA04A9B896E8A6CDACC8B9C6A93A92C6A5F199699698F330302C38C4C203A7135A3035D430AE355D0DD63399999A3389944CA265114E26513242F67E0875692378EB5466527F25CBF8DFCE34A9D5A32FA7F0E454FA4F19B7F4A823EDA7DB59F6C17D345C042E1445C748D3039BEE789898989896383FE4626262626262608C11823046B46A46A43A10676D4CED603E244ED0ECC7C363E19D9B1F0E43A28C225918A1248C11FEFF0091084AA35C362E35144251B318FE1E4FFDB631313035981C48FF00C8B1667BF3F5D2C58B162C58B162C58B0D0C68B782FEEFE3D383AB5256A3194A3114A32294AD3631FC3C97FF0023AA4587120D5392E5C055E99B606C8992F0B164591898966599ECF67BF1F43196EAE488C7F8972E5CB9F4FF00FB9CBDB95DA9B8BA73DB18CAE98FE1AB3CAB29171116C573D8E2CE3F1F611A7081646BA669A66881A4D3230AC5B9265C836D637B3BAA62E55162AF4D99A2E5FA7A3F13F12A59498E68CD966CC45F35C8A72354CD3334CCD133448EDE476ECED99C683A3565F8CDF155FB538D4B5CA0EC31FC0BF23B689DBC4D08D28D48D68D68D68C1A2AD35197E2351313F22F50CEB1BAB9DC720EEAB1DDD53BDA877D21F31337D0667C766544C90EAD547755CEF6A9DECCAD2751EA9B349AD9A99AD9832A2B4BCEC58B7871A95A38A314628B22C8B22C8B1624AE93119226AC5FE06C841E38BF8793FD9D19E8F47AE9645916E96F0B32DE172E5D1745D1745CC8ABEFCADE7C7A79CD2B2F3FD1B2E7E6CC0B3899B43A9290BC98D94E39D4321D444AAC0972302135523E15AA36B248CD192328978978BE962C626262CB32C6259962DD2DE3EFC216CA7C74C9D19C7AC55CD7EB0311C7AD8A14F5C3E0E43B555FAC8BF4C51811F26C948A10C212654A8C9CD12E4D089173E49469EAA5E0E9C190E3D3657A518468C779D9C8ED2676933B4A876B50ED2A1DAD43B798E84CD524607A1CA08D948D948CE99947A623A7235CCD733091691690A1217E4ACC9D0532B71DD154DFB8B314CD689D34385BA7129E52F8651535DAE3272AB125C9713EE763EE94CFBAF18FBA714FBA718FB9D03EE748FB8C4EFA4CEE39122FCBBBABF51638F2A43E3C0D5C644234510AB4E26F89B62648BF581C9FEDE147FAF5AAEB7DCB3B9677323BA91DD4CEEA677550EEAA1DD543B9AA77354EE2B1BEB0EAD47F0DD977D2C5912FC632AB29C484EC46B0EB0EA263F658A7154E1F2B1D8F46491B0DC6F3B81F2246F91B6665318DA2E64290A46466D0AB3378B9046ADD57E4C71E0BB95DDEB7F26FD3F64B8D11D29C7A5CB972E5FF0081295875A23AC87590EB1B4D866663AA8D87E4CB162C288916F1A67263F97014A0EBAB56FE55CBF5946321D11C5C7ADFF80E04F8EA44B8511F0C7C666866966946989ACC0C0C0C4C4C4C246A91A59A4D26942A63A4994A0A2723DCF191691691691F91ECB99199B11B606D81B606D81B626D46D46C361999193323265D972FD178B8458E932CFF008763146B89AA26881A2076F03B781DBC0D1134C4D68C118962C58B16EA89D284DF6F48D34CD348D148EDE91DBD33B6A676F03B781DBC0D103444D113444D3134C4D513544D5135A35C4D513544D5134C4D08D08D08D26A351A8D46B3031FFF001562C58B7FF7EFF3FF00FFC4002E11000202010206020105000105000000000011011202135103102021304031504114223252612360707181A1FFDA0008010301013F01FA48EA42EB8FBC42111E09EA8F717BE84210BC13D51F4285EBA17967ADFB51E04217D14F5C7B51F431E39EB8E99FB68F1CF5E3D33F6D1E16327AE3EE98C6318C6318C63F0C48C63F798C7EC3F51FDA210842FB09F663A249FB25EB4754C7FD1B24F24210B9C70F29F883433347334B3D8D3CF62B96C29FB88EA92794728C264D1DE45C1C7E7B9AD18FF1C49E37124C67298EF2773B9DC796E5B2DCBE45A467FE8EDB1FB76146C5712B895C4AC1582B1B942869C9492B3EC4F9A3AA79630E458E3F26A447C13C4CA7A787F1D0842108421084210842108421FAD1E84754F2E1FF00238DF3D7C3FE3F5B1D33E38EA9E5C3FE471BE7A9984F62D05A06318C6318C631FDAB267961FC8E37C8A45FE8B1FCE444F07FD353871F189AFD923F5126B9AD1B1AB8EC6A63B1A986C5F0D8BF0F62FC32F817C0BE25F12F897C4BE25F12F05E0BC1782F0465124C47A0C631FA8C6318FA35B327399F930C71982B88A05028140A050282B05605028140A042E6BAE7E05D33E39F618C63EBC3F8FB6E3A67E950B9A108463F1ED65F1D53E9210842178D084210842113CB1F6A7E3EBFB0F9C4CC169D8BC97350D49D8BCEC5E763524D492F25E762D96C5B2D8B65B16CB62D96C5F2D8BE5B17C8BE45F22F917C8BE45B21E47C0F9CFD432C58B161C0E0B41130763B1D89505A0B41682D05A0B46C42140A05028140A042E89E6B9CFD44F858C64C93D587CF932F7E3DA7E0C3E7C997BF1E588108A952A210842178A24705A0B41782F058B0E761CEC3C8FDC7710BEC9084211582B0520A9528524A49DCA118EE563A7BF242108AC15263DA8F3C75318C6318C631FAB97DB2F063E7CBEA23CEC7C9F4479F29FAA63191909952A54A9510BAD08B40C658B0F9B2D058B172C3FAF818C7C90B9AE4B92111307618C727EEDCAE453229254A4942B028E79FD522B2564AC9DCB162E5CB972D0383B085EA65EBA10B9761C0E0FDA57132C623F0429FC1A513F124C2EBC78BD92350D4353FC352362F8EC5F0D87C3D85C229C234B87B9A386E7E9E3FB1FA79FC49FA7E27E0D0E31A5C5D8AF123F03C8B4962C58BC178233C4BE25A065A0BC172D23F66D31F039232DCB46C763B1D865CD492F23927AE3931F4318F931F3725F2DCD4CF735B3DCD492FFE416C7FA9FB3FA95E16C4E387E098C450560505609F6AC3917927AE3D89EA9F627B11DC5CA63D3C63098EE69ED2524A65B159D85D4C631FA13EC6447B2E4B646A67B9AB99AB3B1A91FD4BE1FD47C2DA4FF8B792BC3FEC69C7E3283472FC4C1A3C4D8D2CFF00A9598FC1DBA7BF29E4C7ECB27A67C53E2C7B88428141582B0520A414834E0D334CD33F7C7C497E2EE6A710BE5F9881C7F53F67F5FF00E8B85FE95E16E658E1F893FF000292A544227DC8F14C8FC387CFB88CE3D97CE23C33E3C7E7DD910B9C7A311331DBAE7C194BE4B9291753272931932EC5E4BC9792F26A49A926A1A86A1A86A1A86A1A86A4172C58B0C6318C7C9084C9C57A51331F06A38EE2823134E3729FE949DCAC952A211D8EC7616276E95D524197C118B34CD334CD3834E0D3834E0D3834E0A41482B895C4AC0A050763B1DBC33F059FB48421085E342108883231F8F724AFD0381F9A4C7E3E817A8C67614152A54AC158F0B18C7CD92632381C0E06318C632C58B162C58B162C391C8E472391C9DFC4BD66318C6318C7E8B18C6318C6318C6318F9318FFED47FFFC400281100020200060202030100030000000000001101120210202130401351315003226141326070FFDA0008010201013F01E142ED4E6B363D73C11F68C794F046A9FBA6318C63E08D53DA7DF63E58D4B37D89D6C631FD04E51AE7BF3D89D13AA34C6BC5A63B53D89D13AA34C6BC5A63EE10842164842235E226338817717610842108454421085C33021111DE4217617517DA318C644FDA31F5274C4FD021084210B35C2FAD3A6089EBAFB09D7194C8C63CD9681C0E071F75393D104124CE761C9BFF00A6C4E2DCB162C58B162C58B0C6318C6391C8E4B162C58B0C6318C631F5238A754104E48D864CE78BE74318C6318C6318C6318C63196E15DE9D519C6BC5F3D763FA59D519C694564C58659592B2210BAD1C339AEDA2233C3022A564AC959F654A952850A95292524A142878CF19E33C678CF1942850A1E3270AE847650842D15811F93162892F88B48E472391C8E472392D25A4B48E472318C6318C7A235471C761085C1F93E7B51AA3896B89EA3D0C6319F93E7B587E7547498C6318C7C6C6318C63191BE58FB51F3AA3AEBA0F44653112530FB29078E0F1C1E38F6530FB2987D9E3C3ECF1E13C787D9E3C3ECA60F65307B2983D94C1ECF1E1F678F0FB3C784F1E03C784F1E13C784A612980AE0161F46D22CE3E990B252210A4DC52567D8A7D9FB0F10F1185C95FE942850AC8A7D92E0B49692D25A4B48E463D6F38FA8FF78508A911AF17C7247FD071FC7261FAC9918C6318C7CD8A0AC95929278E4F1C942A563D8A3D8B09FA9B0FEB3781C8E4726E391C96C4392D88B4969F45A7D16FE16FE16FE162E5E0BC0CB933EA473EF4EC6C32310C65A4B491DA9E79E042E3F83E39F0F02FA0927AB3C085AB0F23EE4F4164BA48C31F4F04E484549C231E6C63CB6CD68F9D8A4952A54A88421152A54A8BEBA0927E45932C319B0A04281084564A6222260ACFB2A283F52D84B41682C58B1691CE787EB1E5582A50A14292293718C63EA61E66318C6318F5A11B8E4899F66E5E7FD1EBC45A4B4962C58658B162E58B1681E11E13F53F514152A544564AC93864AC8A7252524A158176544E7B8C63C90A05961D78B35A1084210B3DC72392C5CB9E43C8790B9691C8E465BB685CB875C8BEDA7618C89E48D73C5B64842E75D982735C91C4850281084293737CF6D0A44211B1B104085DB8D10471470C989C48E47231C9692C58BC9792D25E4BC962C58658B0E063211682C58B40C64734714E89E288170FE48DBBB827B2B399E18DE78F16F02CF7ECC161C75D8F38E0C30A3299C90D6A50560C508C3B942850A142878CF19E32850A149293E8ACFA2BFC10B858CB22313E92121926F9A148A45254A95FE8A0B1682C5A4DCD863D588C3F24E34798F31E693CB27964F2C9E5C479311E4C45F117C45B11691C8E4DF92379230AEBB18CB161C8E4DF242C97131B3098FF00E5DC82C3EBA9C90842108AC88D87C707FA628DFE81F510A4B622F25CB972F25A47C884220C50564AC8A442108422A54A952A54A9510842140A0506DC2C7D54214151084210BA28421084210842164B958C631FFE39FFC4003E1000010203040609020306070000000000000131022132031133911020304041A1041222345051718192426160A2E14352627293D123708283A0B1C1FFDA0008010100063F02FF0080AF62CD54BA3EADFEBA1861946FC0B4AA8D0C276A2894B92CF879987CCA1731A2CCFA8AA22B5C8C4525D222CC974953BC18A83C2BEC530644ECA12761CC9D8AE661C65118D1E47D5915F23150B92D215F7F0EBCBD09A8C49353FD3BAB0C5E893F0F875D7EC977E05521D7BE15856F4F3292929519465DC61F5F10849C48862C27661588ECD8DC7917F596F2919478B32A8F32B88A947E470C8A532294C8A10A2130E130D333093330F99865050505231FE159AC57791DBB0EA279DFE1F7246A85CB1290C5D5284294190641906419061861861861B6705FE7B93780A26F5720FB830DE0376F489F6F11BD77C822FBF86D2A52A523699F4697F313B2E661F330F9987CCBA1B1BD4EE51E4772B4C8EE51E47728F23B94791DCE2C8EEAB913B0B8C24CCC3430D0C34284284294C864C864C8E191FA0A967D597993EA9359795FE1924D471CB9546292930CBE186E527691FC8C4B4F915C7F22A8FE45769F2312D3E4635AFC848A2B48A3EAF9B94F32842842842842941906D444FDE454F0E8FD7738B6965EBFF9E017AED9773F738ECECD7F8937FBB6CE84F60E395152150E38E7138E471C8BA77F090B0C56972A7D8C4E456B90F11F51282330A23054C252829218A3925E4E31F7D55DAB6C381C0E05F2BBC8A6130A1516FE8F0A9DD61C8EEA9913E8977B13E8EB9185126661C7CCBEF9DFFBCA4490C307AC482A456302FDD213021F8A18685371C3456565454A3A9C7C26EDDE512C0A8B2584BEE7F3D0E3EAB6E131F7CBF74FD46D302FE0D93432D3C74701D07F15EC93B23B565114447D59155C4AD6125690E6798DA5F44D48AD3ADD6EAF908BD589228BCD187D0FAB34D0E9E392B48D3DCC68F33173443E85F5849D9C1CC9F474F9172D82A7A29D6BA24F630EF3090A2125D54F484AB9150E4C63C87D0DA53C35F4395A15A15A1520E8701861B754DDFB5A1B4B0C30C4D550BE0B55F72FBC9EBF535590A10C34308C25298D078CC48B33BC292E9062229C14A10C3430CA065389C472A2A42A4CC74CC9DA21F5292B33C8AB7987AF022C89D821D8EB41CC95A72311322B43110C44C8AD3E256B915C79939FA90A796E8C5285083733EACCA94A874C8E191C0A533D2C30DBDDD0A5E76E3442712A9743C3734F164813889676676E23B2B7ED62D748B45454543E96D9B6CEFDE225F242388BD4BD0EB23A3ED235FBEA30C30C2AC4B75C5C8883214A0C71CC95A464AD9495AA643C0A61C2BEE4FA3A93B18F2268A85656563C270291974AA3DCA791E64B7290DA8E38E397F0590A49B42FF1176CD861B5A4B717AC71FC8AA2CCAE2CCAE2CCC48B33154C42A38686292927648A4FA3C39184A9E8AA4A2B587DC9748B4F743B36B0C5EB0DC70CCA798C5F0DF7AB931861861B7A9E9EB6CD86D822F90C31C064186D1C4751C71C7381C06D0C30DAEE3A88BB5F4D97667AB3D8DDAB7BC22450B2EAAC290DE4EF41C727115A1520E9BB7A9290D7EE90F5A82F46FB6DA6EBA2476AD6087DCAE28FD10EAA27561121D5A465CC558798A88B670C48DD8BC7B1FE97EA7EC7E0358F330EC7E4A60D8FF517FB18167FD553BBA7B5A1DDE3F6B44302DBE70983D27914749F81FB74F5B3531234FF006D4EF1F90EF2991DE2031ACF3312CB32AB3CCFA73294CCA3994A94445310D717E89C3EE22DF7A2EC3AEAC9B2BA243AD6717B2982ABFCB1FF007306D3DE13B563CC9D9C4536834791F5E43479187699183684BA2DA12E8ABEE5E9650A7AA95594276FA5DDE876FA444A34517B94C3092D8AAF9124D0C30C36AB8E54564E2193E232643265ACE3EA2A890AF0D82429B7642942941B5DC9AEBBEAAC2AE5E45BE5CA7656E1AFDDEA4D561B45487153CB69D63F862622CC71C71C71C71F779A125269BA4D0A4E398F1663C598F16671291B5986D875781285B89494A94948C7EA870CD074F91543F22B87E4570E657FF655C947FCAA7D5F051A3F894C7914C79145A72288F91871F230E2CCC25F9185F98C3FCC51F98A3994A13D562531B7561861861861861B67DA8514C3430E130E1C8C387230E1C8A132294186186186186186186186186186FF0029BFFFC40029100002010303030305010100000000000000011110213141516120719181A1F130C1D1E1F0B140FFDA0008010100013F21EA91311411946550A2E948C362A32A14547599752BB2627D056C701B017B10684241D2AECC040A940E841048A17D1C42E63E64C2FAF344FA9EC48A8CEA25614D6655813325502A0856424224FAA902EC2A8A246C618CB1051524926AF154702524E3DA8DC744820823E949349A21519D6D0C4D42DC9445CF43807C470730443968543313352FA1A190C092CF44D9705168C6E891087818BE48C4EE35E97831E8B459760BA48CC11F410A8CEB68626A1CCB460B1B4A1DA20BD49404220C4C86B1F434110E9C92C50D557210418C3A21212A2C139910D7A74A4E0CC289712E25854554BA161F5A1743C0D0C6846517284924883216E5EA102424330321AC79E94C932DA2CD0B34A04A92188450825546C4AC4898D7A3431A358A64643C51A990952EBC6AFD210408546546268622488A199AD1E47B8F7A93131B313166B1E7A721705A54169CA8A210343A88A4D2898B944C85966A09D164615642A3A8D5C488A20686A8BA474312473212C642648CC88DD0451458B64C98D91E7A564BA8B01AD594DC2EA987D0D1185C184304220646728A6B24AEA38D71AC2752E99BB8993563A2E91D0C441B82254A5552F0AFADEE3B846E4FA93938FAE2D16CB14201C82B721B8D771A6E34DC7B86E04EE2373744BA21098991C84B7A66A1DC3082A15D361AE4F4061B10BA474301E2921C87799E47CC95E4461D47C87C87C86C3763764F5BC880B04CB24E3691BA8DD1CA306F1B351B7527D496E4D249249EB3A246C74104574846EB24D50BA8588D495458306E48992DC9FA8890F4868C74820823E801993264C993264896C41040D0EAAB2391FD042E878D1852B83993D8E02222FF0087227A0DB61CB4A267692D896C4B625B13D8ED27B13D896C4B627B13D896C4B625B1D9476749D12E9430D74A55205574989A5320EFA118E8121EA8FA64D0709888D8EC3B2BF691D88EC47621B10D88EC47621B10D8EC23B1DBD22D44B6228685D6DE28EA95730D0BA5F4A5481C461D3E713A242624411F4A4C08B867805C0ECFF8B87E1041C4719190322A88B16210A28D5E88A56284832174BE959669781962A89712964E708EDC11100D41E5CA210B91194C29C1C4BC9FD19CD3E18E4781760E943E161701D5BA1BAAA882064A251289458944AA4A195EC7111B1C5D2575167A2A45E88A494B5C6EE2E97D2AAC8E3B09AAB06749B145A41A2FF09D7EEAC615ADE2592258F7843068580F795C39B5EF36D5E83D0259857A0986FA85FEC6CE7316B4EE911FDB0832E1B8FC9B67A1968FB1DFF604BCF8D1A9584ECB43BEAEEE693C0C9C21E820408111A6E4371A6E3DE2066CD2805351895FA68B90451B459418BA5DE2AEA623A40A20B842E0876950B7F187512EA8E0F4811C3204288B12510479E938D77426487C4EC443610B0161B86B23371F325C92DC65096E39291425A5033518BA659A5CA58168B945D2EF1535A5D12B518930771F3D520823C40476F73B3DCECF73D637E4910C8E591C91BAA770E5122592C964D3D0CDB72EE90D965136069ACA24927A5AA568899950AA1E8C842111ED41AE2174BBC54C85410203B6B6CCC8274F0C965D843638691F33B1CD23CF80F8EA05F663ECC4FBD0DF24BA186C9A33D28E0B1068DD442606DE08D60898252C3C89D23A10B424490515D1D6131512A4958C42E9278A2021EA4698612BA20953742D950B766499D9C9F68F42B8FB9C98E7E945ACC4DD49739660C23B316024A5609082FD5A396FD02D64C37DF43E4FC2485267CC73A6870C703C9BDEF3FAB385E46C30162DB574F80F69F1D9AAB7847266A3529249A258CC3C74A1D241740F2510BA49E29888D90EA778F98F9D29C92023CAD931CD789E6E2AD39571AC1A419DF1C7C50FF443FD51C71EC0E19C0381E0E01C438043644764476476AF0762F044811AEA9B05264C84D2ED48C78A4B303CD55A86E84C9B51619A433942668700D6642B22A2E4410217493C18104D2993244C9E892159087B2D0746C1D376548208AAA41041041040E961A8C821B6F04E0682D025D8FA18C4C52C6CC4E6A844434E10F6856C5AC0D71D102A6C40BA49E0C0D42DC913244886484CC9098E08D1B439294371B0DC65F13B46DB132437A228822B047432E24BDAB0D4411345D12B63CF4AD89B243D2D11D029AC17D61AB13403888B422D04B410D083A89E28492762283175125513602D682A04061AD14D2C30C3E343AE95486411D0FB8FD4E3C8BF5B09103C93D05EA9260FA1D2804881081A20686A9CC34C0A5A12683D81A6C39A0A2C139D885D0F04546C96C9E9B5419E11AFC14D6F44FBB112C08484A52123CA1A44E53DB1AE8812A1C761272D9B5E71F2C3E7E3FDFCF999F3B1827FEC434645F267CB9F2B477FA4E84611C01DB0AE496701F250E1C1276B6A6661AD51BDB47D4452685481A1A1AA2BA82F6683A4B088808F51DB927A17105651231A49925A964810DC9E941BADA1B1CB6F22781A54DA0578B61A3EE3425FD923FB47C90F9A96E15EA1E82BD67B2964F916F3D58F9C3E5A930517AF824340F6111D90B6910A597DC3EC5CA962C0798848F47D1040D0D102E863190454440A62424B8814A1D8B0913264C5D39FE074FA112258B66D85759DEB6F71C97228686AB2C222E16BBFB70C9A912D4D37D031AFA0FA184C91AC29EC6758058E9C93D0E081465FD284351209753D8AF752C3B1F93B3DCECF71F0F71F05E48703701B5C106284406AFA484209079757D2FE8B7D09D066D1C3D1008C517FA27E68155657A0B6E4C49D16F31C87251704E1793E48E379383E68B99E0EFF0003FA90FF00B7241732770582B26A434FEF12D40FF4C86FC4FD10DB95E83678F1B1BF1E163D9BB931D7818894DB34E7811B4E7B1836FC08C1C928E93D39A3E89249246C9249A2A190A189DC56D26963EB6463AD5D467A44936362085D51CA8BB32877C8E013AD39A53836B6E6D8959B436844A9923C2843634DE7D14BFA7DB6F724C449D0C4EC7D7F934FC42DC7116F2A3FA26C265BCA1144D386C7E491DE4B270258A4FEB424DEF4121943B18D4FFBF7399791A60D8EEE7273E40972C3798E49DF1A952C0DD6D6A258A8492493518924926AE651EF2491FE821242912852112211088440857ED3B486C43622448683421B8FB0625B2F03D77199484AEF426776A598B10D91C8726312B93B0B6883EC8969C525972E2DCF03EB63991A8AF0BC19274475524924D268496263A39F4C8C8080657212D740820822B0CB972592C9E1781B5B22571E495B08FE111B1A20452B7591A4E7DC6D41089821B1C076225C0DE7F4486CC965C725C6931F5DCA08C94E072A5CA21E493515074955484C964B2504E1991D2BE98A704628231DAA49344A2492C3ED4B16DC8E4F450D704B6676105B7649CACC27DC873944B77E889EC25B7B8D370D5007B842DC4B91D842D895B22F509933B7D06A7A124867048524082095104114744E61F42E92493B12959021108CA9322DC1A45B990C89AD2D8727646F2BD082E520927D268CC81CB10DDB0BB3B18B93C111EE1B89E513B0D19285BC0B5B2E4B316B530306935D31AEE1B35F71CDE25F91A1316E1136A6E4F51771AACC792053E82B8D34821BBF039AB3649E5B25DE07084452081AE847889E8435454108E8926862C0D23191A97559321502C98892F620548EE08D942FC0FE82744202DA0D5A1B0DAECC4D788712D0A31BA3BAFB199FECD89837DA1F72511FC1D84A0AC24868F45943F26E16ED24418E0C0C3906E767601EC7DA25889C23BBA2C373DF04AF293B0B739BB2FD4870876D16F40FA1226A082109A2044810224489120248C4A393246A20820487825E47321A9645EE6591CBC37E83DA115CC824C4B869F837E04BF98FDA86C06C5CC7906FCA80A6B14D4340DD0D917A492496141017F5C497225D914749341ADDA2361CD24927A4988A2AB17404C993A206EBA930CA47BC0D107ACA92309F951B2958529B310F4420ADA490CE16271426D09EA728DD9322071034419C94F81781194326FA8E40D23F218CFA03FCE0DAFEAC7A2BF51DAF736C7DC881F860432CF41A3213D46F37917EC86AD073F80BE39B11F322D202C5BF5186EE7A57260BFC47B2F53505D8879CC5DEAFE8C935132492689249268F07765C8FF23B6BFC245036919C7D4B55807C112FD040148E87D84423804983EF48908A1275E2AD2F61CA9ED3B0EC3B47B0710CB886CD0E038FE0FC0430396BB30CEA85AE9ED8F93D52A00DDC9ED79C086A761B2435683A6DA75F716C0916A9041047D342E99A491B08F8357A54BBA24C743745D322E3B2E8A8760CC306C4E84087B17D89E09E0944AA2110A25CD13244A96DB0D87C19604B5445228B435FF02A4924926615B3B10CA1C5D98053E588AC887D9DBA1B44104558B2593613A2144682E8AEB2399943413F4F924D049A095C16D910843674F988EE77D6629CEC2586F81C161F2F63B4948C422C84B9197718C6364924F54924924924F48B27AAB2393376A58D73A5B14DF0D0B6A6308837F4BC1CA2F413ECC67B3F06E1E0686435B86E47A08371000DC2D99F092E9F463D16BD9C8E83D487FD2911E4F7307DC34439EC0C1FE06991637AC83DED34613DC60144FC23F43E517613F663FE48C4F74F8237FB107A72116E61057561BB08354C4243B381B18FE8CD0DE1669B851DA3917461B944E6DC121384C59E4F610E4875E12094F60D541040D0C6E0B0CE3895A05B238C5B02D8A1C0605E646DBB5F21B45A3DE31F9470F204930A102B124E1C49D2CE4F021CA4C8F2A2D4F79FCD9EE9090FFC8147FE683EE7D922FF003C8C29023D1FB15ABE216EBD896570C66FFA927B9F46522D43D53AAA31F44740824921E73A9C6701C0711C4711C043621B1DE90C560C9A2164C5B8B90E89558DD0595C6689A6B2C4F5A60E4369E82562084841395C9BD93F89216CCEC280D272F035FD476469EC1A7B8698E00DB62E3D44F23B1F821B3A8F29C8717F24B989EBD2503A3AA114926AF9DAB0B57D06D24B7088B42770B51C172BBB8FF385A04C8C58981040AAD49CAD0AECC21A213CC0EE46ED591B54F48C3A9A34C7B01B93E9257AF8B09374FB18F505709DEA420F48CCB61BBD07B1EE7121BEC4B663D863E03E040C410432FC8DEC1B64BD89E1781A04D5AC3279177716EAB38BA4950CB15549C2CB1695A93F42E93B31A4F26D8F75C85465C0D9A0F6165BA246EB97FDC32346004AFDD26CD707617B8CA4B7DC523D3A72C9E96114BF249D86D6970EB611A3596E4BAE1063DE5F739FF03F85FB1CC0BF43F846807FB4FF00A7E1FF00907A63B36FF06CB2BF53FB0D2E7F85B192EE89AF6F7812607B1EB224D71678F3093C3C22DA6A6B480FF451FC00C66AFC0C9BF113136FDCC4688525F2A9D8E1978311D8420A169869A07083D1C7BFD2BB023EEC0A7C190FE06862B6E07A2B1E67EC2C0CFEF614F63D9A16A7817E46FD1F4FE47B07B62970C0E784E7D879F3CFE07877B84D4645FC64D16F65FB317F67E0CE3D3D66F91FE6452C476FA89BA899A89DA9125162090D7B3B77620565CB3813AEDC31EC07B28E047687BB49FCE4E4F96730D44EE86DBCF8442FD31C7E80E365E06364BE497BFB91EAF34177A8D47B48B45C4231E2D221B412AA0320EF344AC93F511D87C10FE39A2F00D5681C344388DF4A26F1B7563765FC8CC7BA104C34609858C11114EE6318D330896E1CD3D2C4F5BA470470470470451A18E381C6FEE38E071BA2DC16E0B13D8EE27FA070D03698F5C1B61BA138244E8452922FA6A8DD85E52BD0D037D6A127663E2CEF130DF85EA246E78F4913A101514FD028A321C8CD2D47595DCBCEE8963465C431717171EAF27A87DC37C89E5D2DC96E4B6CCB6CCB6CCB6C5B61C6C5B61C6C38E0B1625225124070269840FC7333C77A4D124924924D27A10A8D4921825F746961D88F0D7D42646B23D6F20DE97762468122C2131388A5128B6309C1305AC2293616C0B5A19842CD1A38251DCB1EE1AF5FA1F1C3DD0F75EDF91AF957E46F6FF1DC6EBF97FA3F8E21B5E8A3BE49F838DE9FA53CF7A4F7C0F4DDE07C188FEB9FC150D3FDA3E2E485CA3CD2BF9621B10EC9EC4E1D0EBB69EE85B20D4E1B0AB249248AABE843627D28270F60718E01C0A0E1893A05B238086C44891A9034594224380F8C1FEAE7C3C7FACD35F04707C1C1380710E31C2385D196E31C038C710E01C4388333D91ECD086C351A8D361861D3924924924913AA6492493F427E84FD0910FF00E07F5228C6870341A8CC44C9249249A26492492492492493D5349269249249349A492489924D249A493D124924924D649268926B2492492318D8DD3FFFDA000C030100020003000000104993DEB8CEB26B052CCB0F69B61044231F48DA8CF23F31FB0ABE24243AD925B6CD771CA85498B61CCA61AF606752D89A916749F75A7632ECB94B1AA6CC9249BFFCB021A445A07799D2B1B5B88780B1F7FBDF5D66112FFE6E42B1D62AD926A242CE8D3D28302CC1B215B4F4E133641326A96661D0DC4D918823364D46C59385BB26BC58A7260B29AB063AAC0A6DF595F1DF93F1BF060A63D4AD99733C6C0D150EF6EC449A324EFB9B4A915461B8A2239F43E859C7009936752B9E9207A185188B4A4DC3F6EC2001B74459C4F138D356060135102DCB26587B62BC77B1358290B0A492096B126DB6FF00ADE6119E669568645B8C910640BA5AE295691A6A9056F6920120800010BB1E5162BA3078C9B33C220E3B5368CB659AC13E24100804092D8483436FCE004C92DA71833F662E9345A49D96C96C568EC020492CB258414A72DF54BD2B6D46D126B8F3B2F0E0324B645E5ACE24004ADB668CB649479E6BF35A624B5700457086991E6B53B5A76DB3053D08896EDFFD77FA4F3AF91AD9C1B5E381089403EB8BD1DF62591D8DBC6B46522609009773BA8299B02008DC04113510E3F04D0E2FD808A6BEF15F8EE508427EF926816BCBEA515DA699A222235A89FF00DD1D592E38FCDC696708C9554CD26A680417C057BBBCAC44C64625C7855289E28A38A8FB0C47459741C0BAADDB869B36E32E8F2801AD162A1F14D6DA1C6CF98B7238707E039EF06249FE225B80841F53B0831AA6A8879267E9058E2C22CD76FE5DBC9CA5D2134E7A8C0C389DE4E162A77D7C0962B8C793AAC664246FB4D6FCC63BB499009501D86ADB99428C4AC1DBB0015F8243AD475A76C0122EF14C7B6DA12815CACBFD5AA7459A95CA26EBF4F83A72988F5E824A697DFD7E74DAEE249831D195E736421418FB2DEBA11414A7D68B2A4DB6D7C9B28829B56316734FB0F807B6BBD2B1B274FE63C2E24A4D6744D2AEB6AB5DF6A86E1FB9D28455DA5BBFC6B960B156C13A3FCA3810FF00860222159071197C9A7918572394DA96065C24072D6ADB6D17204295A828F9F22240A38CDD25F17ACE4B0D5DA4EC04C0225869B6DA2009DEDB54D2B3D1B9812733B569F39BDB8AD29A45800CA0482478E49F5DA304815D5ED5D9D08F4DFBCC59D97B2C0ECBF31B9CB3B8922DC81DE66094ECCE0B4892D7C0B8D3BF40B6412D233619FC78C7FF00394D5AB5EDA6E34EA90675AE98404A0AB7DE5118B426F89049381EC7DE77A3D23AF71F391618723DACDE693D74EF84B22C80E4797F6E4901CFFDB3C8A6206281A11F8F09A68E24E3DE0A3C5A49D2481A27C82491F93F6DD2A0FF00D59B83E4D189B254339C5CFDB27F60935AA75F2010412F77AEC92845D204500B7FE9B2366F66D839AB253C9811ABF4E4D069ADF32947B615B667190C5227053F2FC03BAE7D50A62007C7FF002C8D2913701A302D3984C244881B05B08AD8D6B80E1EE66AD36DA40FFEE7BE248201B273AA4BA59315ACDA87EE0032E39808F29173C0DA4DAF6CB0C909F5AABB6D5507B649C50032534AFA487372113AFD84FB06DB664D9404CCB2BABB22198A403997EC0D956491334B373E5C65688125128937269A37032C743D8A5C503C74F442678559441684F43609F116D109D26089265403D500598A254A103D9F1C1F51497FA1AB73113A2F2D20DB64C91362D7158C05F9D5DAC926D10339757F4B98F1DDAF276CD4D5DEDA3DD6420145804BA1B4400C4EDB84178035EC61EFBF198DD452824399F1A320028254480121CCAACCD1248E12CB06731E8972ED98C626A96D282304195891BDEDAD74BF7C2FDFB206D4B2DDE43D5C11900E3D26B06D9540291775DCC764A59805D179534EFE415259FEDA969C2533317515F609A5DB67CC0E4DD436A5622932C962D1B2DE8D76C908ED2846E44E8EBDCBC1A491B572B8215B81F8B6DC8DA1DD8C9FAC611819958DE89C3CEC2682F04FFC9132D491364956622F7E04B6357E5C441B4E58DEDF5D20ED6236E266F20074D74D36EDB0F90437E36894BECCDACA05541FA276DF1043D99BBFEA091770102FF9E9190E48CAD92496466A5609166E55FEC7B557FF00FFC4002B11000300010304010403010003010000000001111020213130415161A1718191F040D1E1B15060C1F1FFDA0008010301013F10D54A5294A513294B8A363E831EA420914A5391861AD49D0631E61084CC21083FE05C5294A51BD0B4B1E85909A5310D09A509D063D1352CBC412213084213A74A52E85A58C48820B2F610994219C74A1B5B18F44E8BC21220910834412C9084213A6B4B2082090B2D62132B1C75262C213146F5BE9AC2620C82442681068689D15A5884B2B08797958E3D4B43E9A1EA5A4CEC2CC2106868688421084CA1684310B49218F0D65638F5663C5C52E95A9628B2C62D4C641221083435942D2C4B51718841A1A2618DB6B6D463EB52E294A51319D85AD944F431E85A90862CA94B8D870AB061B5B89DCB637D3A5E8D2E294A5294B86C6CA5294A3637A16AA51BC16179EF1BC77D12C0830C5294A5297F874A265D01B1B1B294A52970842D7068858314A52F5909E17F8D0841A1E2E8A51F490B42C9636186BF8488421084C4C4210842755E4909108420D69842650B42C21C170820D7F010B4D294A5294A5294A5294A5294B9831904842108343434420909109A1694314A5391AC0F309D3476D34A5294A5294A52EABA68C68484B4B1A210841220C7842D2843C2110439610418797367FCFF00A26AA91E9F94358F67F07B9F8635729E2EC2D0D131084D5084647AA89E1904B5319083CB1E50B4A108412CF1C121048E0915DA47786171A477985184F23EA2F992C37B46DE67E0DDCA5F822F017A469BFD8FFF00DC7913F81F819EC7F83C2FE0F76234F28A7DF04FB0D5CA2108421084CA795AD8B498F42D2B5162CD807E618F883BB0DB7CB12598E66C6C44411A3D945145145615A41A959A5CD2E84F4AD0F27963D0B4AD2B93384E5D34A231B9B9B9BE9A5294A5294A5294A37B1084E9AD6C793C3C1E85A560F170871B384E52E8A88E111967B8F613E4FAFA500A5454545454546C36A3294A6C350A5D6B14A52946CA2651B28D8DE95A5099743C06C7882BB3628ABB17DC9FFF00057FA10E537E17F6263FEBB8D1EC12F4B03BE57C1EA7E0B76E3A0FBDF91799F93D0CFABF07D53C34FA87D4D007D5C3F50F433D4CB221C3D0F8CDD4B0DE906CA2652946C6F4216A4C592CB2DDC2705094571A8A2DA17811EB47ACF41E83D07A8F523D08F423D47A8F51E823C104444411111168E61B68870D09EAED86E6E6E478A5294A5C4D0B4B1BD217571144CBD49AA69712DC6C43D1C3A34A365D106B308421342D2C64264825A1A81F6E294AB1B1B7476C6C6C6C6C6C6C6C5438BD2528D94B9A52E65D6035A1699AC145081D2D863ED3A5B111084210842131B636C2D65A781BBA69745D49E294A5294B46898442612C24242442111514341BC768F93F733D1F25F8F92BC681B7A0F41EBF93D2FCEBDB6CBD23D28F523D48FA58BF5827F7437F7127B9E1CE83D34BD2BA2E562130994D8B84265294704118C6245E83C313F117A93C05E0434763D48F523D48F523D21DB6D00FA0F41E823C10446C6C72D04A683D13F84842CBD34A5294A374138228A34D6DCBA2974B11CF4B1F5674D0947D67D24D8851BD4BCB1BE3737D2D10E59586F43E94274A0BB0D752822C514516595A042621191F83EC6C6C2D3D5104F82BC3CC5E82F88D3BDD0DCE5093918FAF3A4962E1F4938249A2222223622222082049E46BE707B0F03F827CA266CCAED87DA349B33C856F047B11764266E6F8465791FBE1382090F5C213A709D23E85DC6D8DCACACA5E800A2B0A52950E3D851F245A697374A73D0A558842109D35A1E1EB625B8994A5294B8D8D888888B084646466E6E563738DF4D2975707D078822133313A0B43D6B0C4444421084642337162B372E44C8F2529C8B1629B61B45D372DC3B4BA2882D54BD042CBD6F0C4F14516304E9617E316C23F58DCA1A79A6C4EF0FA04BCBE07E62492306E565F23447B09247E02BEE50F9DF334C1227F010858787A11083425A1896E36C84D8C110F041A23984441111DC8BC882836C4F81BF81B789F8FF469BFC0DDDC7E43C8273C8C8EEC992EC4C725D09FC08412C2C31E21084C4210D8A7C1E83D07A04D570578CC904824C14207821B94A5294D8504965E5E5B1D36B14A5D13108421084210842105B2904111F41E817884DBB09BD85D506747F832006B4642108420802F547D2881E5092E86C14E45BC96EFF053FCB2FC7FD9E1F90FFD5479D7F03576634F77E07CAF80D3CA3D65F812F827C6043E40BC857B91E468EE3ED0DBB21B46CFBE38E9C213A49BDC6FF24D44A57FD17C5FE7FC3E96510BB099708F18DA7BB0A5C52E39172529740B92944AE1897C37E4F705FA97F479D27F646FE7F114E50DFCFC8A770BBD87843F11E812BB0BC0224B6D13F8ADA5C9E981B2DC4217410DBEB68CA8A8A8DB1B68DFA37346F6C1A268E3FC868A236AC488899B4210BA2F9D54DE08C7E031F8F11AFB8A5CA21F72B2B2B2BC6104151B68597C0C7965F035D57AF084176424CDBB31A8C42E8BE82139C1212B86250F67C23CC8FEC5394F9FECAF3F22DCA3EE47EC7D9099C7E6994FF114E47DD1F5BF81A3961F2191504D7913F657E4DC61F034E4BE10FC98FC0DDF3A1EBBAA951514A52E1BD0B82946FB8977121743614BA265384A704F812783D05FB1E93D7A5E23C91E4A5C312E47F2C49E1CF3B4FECBFA29CAFB1E75FB368AFDC29D93F053B97D8416E31A77641BB928A2CA123D7084210B86F45294A5289E86AA105AD1B8415741F863713BAEEAA529F6C529515151B1B0D1908F4F2244FE042AC367C0C42E07D078B104849896A848D89A6427429B66627525A1AB1B2CA741F45E586F78F090909B13D698A048412F084E2572C7A532C06BE4771307ED4FDA9FB53F4B82FF00617FA917FB31FD727EB6647ED23C9ECF927CFC9393E93E92740B4A286BC8E60B44261BE93DA1EC94B77FCAFE84776BF7EC3EC07E21F882572D1F59F51F591E49E450DBA87A05E08AFC158DB1A6F0842108262FC07209FB9F593E4F61EE3DC7B4F6EB761F59E827813C09E0446C6C6C45E08B2F198DA68B14A5EB426124421341920822C51B45D311191E436A94A5294A5294A5294A5294A5294B8B9A6E508EC46B55FE0A84C545294A7B8DFC1BB213A2C6BB92D0D50A8FB74A97A54BA1E5A1869AEA2D1709E1EC47ED863C91E48C5E8225AEA2340A5106EE212DCF71EEC5049249249041041FAD99FAD995E0AF0CAF0CF53F83D4FE0F43F83D07A0F4FC97C3E4ACDF0F4B4B08FAF4A52EC52945165965965945294BAAE2B132B132E814516596514514514514AC28A5294B98421084E83FFC13FE5D1FFE8D099BD3FFC4002611000300010402020301010101000000000001111020215161303141714081A1F091E1F1FFDA0008010201013F10D70992130D10842090965E942";
            


            var imageData = this.openFile();
            using (LibraryContext context = new LibraryContext())
            {
                Book book = new Book();
                book.Title = this.book_name_text_box.Text;
                if (imageData == null) {
                    string fileName = "book.jpg";
                    string path = Path.Combine(Environment.CurrentDirectory, fileName);
                    Console.WriteLine(path);
                    byte[] DEFAULT_IMAGE = System.IO.File.ReadAllBytes(path);
                    book.image = DEFAULT_IMAGE;
                } else {
                    book.image = imageData;
                }
                
                foreach (var item in authors_list.SelectedItems)
                {
                    Author author = context.Authors.Where(a => a.Name == item.ToString()).Single();
                    author.Books.Add(book);
                }
                context.Books.Add(book);
                context.SaveChanges();

            }
            this.Display();
        }

        private void deleteBookFromDb(object sender, EventArgs e)
        {
            if (book_data_grid.Rows.Count > 0)
            {
                foreach (DataGridViewRow row in book_data_grid.SelectedRows)
                {
                    int id = this.isIDAtZero
                        ? Convert.ToInt32(row.Cells[0].Value)
                        : Convert.ToInt32(row.Cells[1].Value);

                    using (LibraryContext context = new LibraryContext())
                    {
                        Book bookToDelete = context.Books.Where(x => x.BookId == id).Select(x => x).FirstOrDefault();
                        context.Entry(bookToDelete).State = System.Data.Entity.EntityState.Deleted;
                        context.SaveChanges();
                    }
                }
                this.Display();
            }
        }

        private void showImage(object sender, DataGridViewCellEventArgs e)
        {
            var senderGrid = (DataGridView)sender;

            if (senderGrid.Columns[e.ColumnIndex] is DataGridViewButtonColumn && e.RowIndex >= 0)
            {
                using (Form form = new Form())
                {
                    using (LibraryContext context = new LibraryContext())
                    {
                       
                        Bitmap bmp;
                        using (var ms = new MemoryStream(context.Books.ToList()[e.RowIndex].image))
                        {
                            bmp = new Bitmap(ms);
                            form.StartPosition = FormStartPosition.CenterScreen;
                            form.Size = bmp.Size;

                            PictureBox pb = new PictureBox();
                            pb.Dock = DockStyle.Fill;
                            pb.Image = bmp;

                            form.Controls.Add(pb);
                            form.ShowDialog();
                        }
                    }
                }
            }
        }

        private void saveAuthorToDB(object sender, EventArgs e)
        {
            var authorName = this.author_name_text_box.Text;
            using (LibraryContext context = new LibraryContext())
            {
                Author author = new Author();
                author.Name = this.author_name_text_box.Text;
                author.City = this.city_text_box.Text;
                author.Age = Convert.ToInt32(this.age_text_box.Text);
                context.Authors.Add(author);
                context.SaveChanges();
            }
            author_name_text_box.Text = "";
            city_text_box.Text = "";
            age_text_box.Text = "";
            this.Display();
        }

        private void delete_author_btn_Click(object sender, EventArgs e)
        {
            if (author_data_grid.Rows.Count > 0)
            {
                foreach (DataGridViewRow row in author_data_grid.SelectedRows) // foreach datagridview selected rows values  
                {
                    var id = Convert.ToInt32(row.Cells[0].Value);
                    
                    using (LibraryContext context = new LibraryContext())
                    {
                        Author authorToDelete = context.Authors.Where(x => x.AuthorId == id).Select(x => x).FirstOrDefault();
                        context.Entry(authorToDelete).State = EntityState.Deleted;
                        context.SaveChanges();
                    }
                }
                this.Display();
            }
        }

        // https://stackoverflow.com/questions/1922040/resize-an-image-c-sharp
        public static Bitmap ResizeImage(Image image, int width, int height)
        {
            var destRect = new Rectangle(0, 0, width, height);
            var destImage = new Bitmap(width, height);

            destImage.SetResolution(image.HorizontalResolution, image.VerticalResolution);

            using (var graphics = Graphics.FromImage(destImage))
            {
                graphics.CompositingMode = CompositingMode.SourceCopy;
                graphics.CompositingQuality = CompositingQuality.HighQuality;
                graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
                graphics.SmoothingMode = SmoothingMode.HighQuality;
                graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;

                using (var wrapMode = new ImageAttributes())
                {
                    wrapMode.SetWrapMode(WrapMode.TileFlipXY);
                    graphics.DrawImage(image, destRect, 0, 0, image.Width, image.Height, GraphicsUnit.Pixel, wrapMode);
                }
            }

            return destImage;
        }

        private void edit_book_btn_Click(object sender, EventArgs e)
        {
            const int IMAGE_HEIGHT = 100;
            const int IMAGE_WIDTH = 100;
            var rowIndex = book_data_grid.CurrentCell.RowIndex;

            int i = this.isIDAtZero ? 0 : 1;
            int bookId = this.isIDAtZero
                ? Convert.ToInt32(book_data_grid.Rows[rowIndex].Cells[0].Value)
                : Convert.ToInt32(book_data_grid.Rows[rowIndex].Cells[1].Value);

            var bookTitle = book_data_grid.Rows[rowIndex].Cells[i+1].Value.ToString();
            var authors = book_data_grid.Rows[rowIndex].Cells[i+2].Value.ToString();
            byte[] booksImage = null;

            using (var form = new MetroFramework.Forms.MetroForm())
            {
                form.StartPosition = FormStartPosition.CenterScreen;
                form.Size = new Size(600, 450);

                TextBox title_text_box = new TextBox();
                title_text_box.Text = bookTitle;
                title_text_box.Location = new Point(200, 50);

                Label title = new Label();
                title.Text = "Title: ";
                title.Location = new Point(100, 50);

                Label authorsLabel = new Label();
                authorsLabel.Text = "Authors: ";
                authorsLabel.Location = new Point(100, 100);

                ListBox authors_list = new ListBox();

                authors_list.SelectionMode = SelectionMode.MultiSimple;
                authors_list.Location = new Point(200, 100);

                PictureBox pb = new PictureBox();
                using (LibraryContext context = new LibraryContext())
                {
                    Bitmap bmp;
                    using (var ms = new MemoryStream(context.Books.Where(book => book.BookId == bookId).First().image))
                    {
                        bmp = new Bitmap(ms);
                        pb.Size = new Size(IMAGE_WIDTH, IMAGE_HEIGHT);
                        pb.Location = new Point(200, 200);
                        pb.Image = ResizeImage(bmp, IMAGE_WIDTH, IMAGE_HEIGHT);
                    }

                    var allAUTHORS = context.Authors.Select(x => x.Name).ToList();
                    var authorsList = context.Books.Where(book => book.BookId == bookId).First().Authors.ToList();
                    authors_list.DataSource = allAUTHORS;
                    form.Load += new EventHandler(delegate (object s, EventArgs args)
                    {
                        authors_list.SetSelected(0, false);
                        foreach (var author in authorsList)
                        {
                            var indx = allAUTHORS.FindIndex(h => h == author.Name);
                            authors_list.SetSelected(indx, true);
                        }
                       
                    });
                        
                }
  
                Button saveBtn = new Button();
                saveBtn.Text = "Save changes";
                saveBtn.Location = new Point(200, 330);
                saveBtn.Click += new EventHandler(delegate (object s, EventArgs args) {
                    using (LibraryContext context = new LibraryContext())
                    {
                        Book bookToUpdate = context.Books.Where(x => x.BookId == bookId).Select(x => x).FirstOrDefault();
                        bookToUpdate.Title = title_text_box.Text;
                        
                        bookToUpdate.Authors.Clear();
                       
                        foreach (var item in authors_list.SelectedItems)
                        {
                            Author author = context.Authors.Where(a => a.Name == item.ToString()).Single();
                            bookToUpdate.Authors.Add(author);
                        }
                        if (booksImage != null) {
                            bookToUpdate.image = booksImage;
                        }
                            
                        context.SaveChanges();
                    }
                    this.Display();
                    form.Close();
                    Console.WriteLine("Save");
                });

                Button changeImageBtn = new Button();
                changeImageBtn.Text = "Change Image";
                changeImageBtn.Location = new Point(320, 250);
                changeImageBtn.Click += new EventHandler(delegate (object s, EventArgs args) {
                    
                    booksImage = openFile();
                    if (booksImage != null) {
                        using (var ms = new MemoryStream(booksImage))
                        {
                            pb.Image = ResizeImage(Image.FromStream(ms), IMAGE_WIDTH, IMAGE_HEIGHT);
                        }
                    }
                    
                });

                Button discardBtn = new Button();
                discardBtn.Text = "Discard changes";
                discardBtn.Location = new Point(300, 330);
                discardBtn.Click += new EventHandler(delegate (object s, EventArgs args) {
                    form.Close();
                });

                form.Controls.Add(title);
                form.Controls.Add(authorsLabel);
                form.Controls.Add(title_text_box);
                form.Controls.Add(authors_list);
                form.Controls.Add(saveBtn);
                form.Controls.Add(discardBtn);
                form.Controls.Add(pb);
                form.Controls.Add(changeImageBtn);
                form.ShowDialog();
            }
        }


        private void edit_author_btn_Click(object sender, EventArgs e)
        {
 
            var editAuthorForm = new AuthorEditForm("name");
            using (var form = new MetroFramework.Forms.MetroForm())
            {
                editAuthorForm.Controls["author_name"].Text = author_data_grid.SelectedRows[0].Cells[1].Value.ToString();
                editAuthorForm.Controls["city_text_box"].Text = author_data_grid.SelectedRows[0].Cells[3].Value.ToString();
                editAuthorForm.Controls["age_text_box"].Text = author_data_grid.SelectedRows[0].Cells[2].Value.ToString();

                form.Size = new Size(600, 400);
                form.Controls.Add(editAuthorForm);
                form.Controls[0].Controls["save_author_btn"].Click += new EventHandler(delegate (object s, EventArgs args)
                {
                    using (LibraryContext context = new LibraryContext())
                    {
                        var authorId = Convert.ToInt32(author_data_grid.SelectedRows[0].Cells[0].Value);
                        Author authorToUpdate = context.Authors.Where(x => x.AuthorId == authorId).Select(x => x).FirstOrDefault();
                        authorToUpdate.Name = form.Controls[0].Controls["author_name"].Text;
                        authorToUpdate.City = form.Controls[0].Controls["city_text_box"].Text;
                        authorToUpdate.Age = Convert.ToInt32(form.Controls[0].Controls["age_text_box"].Text);
                        context.SaveChanges();
                    }
                    this.Display();
                    form.Close();

                });
                form.ShowDialog();
            }
                
        }
    }
}
